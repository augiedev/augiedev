<apex:page docType="html-5.0" sidebar="false" showHeader="false" standardStylesheets="false" controller="FuelAssumptionController">
<html>
    <head>
        <title>Fuel Consumption</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" /> 
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    	<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
    	
    	<script>
    		j$ = jQuery.noConflict();
			j$(document).ready(function() {
				j$("#submitClick").click(function() {
					if(!isInputValid()) {
						return false;
					}
					FuelAssumptionController.createFuelConsumptionRecord(j$("#litres").val(), j$("#kilometres").val(), handleCreatedRecord);
				});
			});
			
    		function isInputValid() {
    			if (isNaN( j$("#litres").val()) || j$("#litres").val() == "") {
    				alert("The litres value is not valid");
    				return false;
    			}
    			else if (isNaN( j$("#kilometres").val()) || j$("#kilometres").val() == "") {
    			    alert("The kilometres value is not valid");
    			    return false;
    			}
    			return true;
    		}
    		
			function handleCreatedRecord(result,event) {
				if(event.type == 'exception') {
			    	alert(event.message);
				} else {
			    	alert('A Fuel Consumption record was created with the ID: ' + result);
				}
			}    		
    	</script>

    </head>
    <body>
    	<div data-role="page" id="home">
    		<div data-role="header">
    			<h1>Fuel Consumption</h1>
    		</div>
    		
    		<div data-role="content">
    			<p>This is the content tab</p>
    			<a href="#add">Add a Consumption</a><br />
    			<a href="#chart">View Consumption Chart</a>	
    		</div>
    		
    		<div data-role="footer">
    			<p>This is the footer tab</p>
    		</div>
    	</div>
    	
    	<div data-role="page" id="add">
    		<div data-role="header">
    			<h1>Add a Consumption</h1>
    		</div>
    		
    		<div data-role="content">
    			<form id="jsfrm">
    				Litres Pumped In: <input type="Number" id="litres" />
    				Kilometres Driven: <input type="Number" id="kilometres" />
    				
    				<a href="#home" data-role="button"  data-theme="b" data-inline="true" onclick="j$.mobile.showPageLoadingMsg();">Cancel</a>
    				<a href="#submitted" id="submitClick" data-role="button" data-theme="b"  data-inline="true" onclick="j$.mobile.showPageLoadingMsg();">Submit</a>
    			</form>
    		</div>
    		
    		<div data-role="footer">
    			<p>This is the footer tab</p>
    		</div>
    	</div>
    	
    	<div data-role="page" id="submitted">
    		<div data-role="header">
    			<h1>Thank You</h1>
    		</div>
    		
    		<div data-role="content">
    			<p>Thank you for creating a Fuel Consumption record</p>
    			<a href="AddConsumption">Home</a>
    		</div>
    		
    		<div data-role="footer">
    		</div>
    	</div>
    	
    	<div data-role="page" id="chart">
			<div data-role="header">
    			<h1>Fuel Consumption Chart</h1>
    		</div>
    		<div data-role="content">
			    <apex:chart height="400" width="700" data="{!lineChartData}">
			    	<apex:axis type="Numeric" position="left" fields="kilometresPerLitre" title="Litres per Kilometre" grid="true" maximum="40" />
			    	<apex:axis type="Category" position="bottom" fields="consumptionDate" title="Consumption Date" />
			    	<apex:lineSeries axis="left" fill="true" xField="consumptionDate" yField="kilometresPerLitre" markerType="cross" markerSize="4" markerFill="#FF0000"/>
			    	<apex:lineSeries axis="left" xField="consumptionDate" yField="litresTanked" markerType="circle" markerSize="4" markerFill="#8E35EF"/>
			   </apex:chart>
			</div>
    		<div data-role="footer">
    		</div>			
    	</div>
    </body>
</html>
</apex:page>